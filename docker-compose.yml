version: '2'
services:
  postfix:
    image: smeghead/docker-postfix-tls
    environment:
      - "DOMAIN=$DOMAIN"
      - "RELAYHOSTPORT=${MAILCATCHER_PORT}"
    build: ./postfix
    ports:
     - "587:587"
     - "25:25"
    depends_on:
      - mailcatcher
  mailcatcher:
    image: schickling/mailcatcher
    ports:
     - "1080:1080"
     - "1025:${MAILCATCHER_PORT}"
  # command:
  #   image: harobed/docker-heirloom-mailx
  #   command: /bin/sh -c "while :; do sleep 10; done"
  app:
    image: golang:1.18-bullseye
    command: /bin/bash -c "tail -f /dev/null"
    volumes:
    - ./app/main.go:/main.go